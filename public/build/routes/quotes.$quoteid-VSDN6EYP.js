import{b as w}from"/build/_shared/chunk-LWBMBOK4.js";import{b as C,c as T,e as b,f as u}from"/build/_shared/chunk-4P2AEKIR.js";import{a as B,b as _,c as A}from"/build/_shared/chunk-BRYEQANA.js";import{a as y,e as E,f as S}from"/build/_shared/chunk-IHFEL2CD.js";import{J as h,a as U,y as q}from"/build/_shared/chunk-XTGBAL5E.js";import{c as O,e as n}from"/build/_shared/chunk-ADMCF34Z.js";var Q=O((z,D)=>{D.exports={}});var F=n(B());var l=n(U());var e=n(h()),L=({quoteid:i,navigation:s,customer:m,user:r,onCancel:o,formErrors:a})=>(0,e.jsxs)(y,{replace:!0,method:"post",className:C,children:[(0,e.jsx)("input",{type:"hidden",value:i,name:"quoteid",id:"quoteid"}),(0,e.jsxs)("fieldset",{disabled:s.state==="submitting",children:[(0,e.jsx)("div",{className:"form-control",children:(0,e.jsxs)("label",{className:"label cursor-pointer",children:[(0,e.jsxs)("span",{className:"label-text",children:[m.name," (",m.email,")"]}),(0,e.jsx)("input",{type:"checkbox",className:"checkbox",name:"customerEmail",id:"customerEmail",value:m.email})]})}),(0,e.jsx)("div",{className:"form-control",children:(0,e.jsxs)("label",{className:"label cursor-pointer",children:[(0,e.jsxs)("span",{className:"label-text",children:[r.firstName," (",r.email,")"]}),(0,e.jsx)("input",{type:"checkbox",className:"checkbox",name:"userEmail",id:"userEmail",value:r.email})]})}),(0,e.jsxs)("div",{className:"form-control",children:[(0,e.jsx)("label",{className:"label",children:(0,e.jsx)("span",{className:"label-text",children:"Other(s)"})}),(0,e.jsx)("input",{type:"text",name:"otherEmails",id:"otherEmails",placeholder:"john@example.com,jill@example.com,etc",className:T}),(a==null?void 0:a.msg)&&(0,e.jsx)("label",{className:"label",children:(0,e.jsx)("span",{className:"label-text-alt text-error",children:a.msg})})]}),(0,e.jsxs)("div",{className:"flex justify-end mt-4 mb-2",children:[(0,e.jsx)("button",{className:"btn",type:"submit",name:"_action",value:"share_quote",children:s.state==="submitting"?"Submitting...":"Submit"}),(0,e.jsx)("button",{className:"btn ml-3",onClick:f=>{f.preventDefault(),o()},children:"Cancel"})]})]})]}),k=L;var W=n(Q());var t=n(h()),V=()=>[{title:`${_} - View quote `}];var $=i=>new Date(i).toDateString();function I(){let i=(0,l.useContext)(A),{quote:s}=E(),{createdAt:m,labour:r,customer:o,quoted_products:a}=s,f=q(),c=S(),[M,j]=(0,l.useState)(0),[N,v]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{j(()=>{let d=0;return a.forEach(({price:g,quantity:p})=>d+=g*p),d+r})},[r,a]),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Quote"}),(0,t.jsxs)("p",{children:["Created on: ",$(m)]}),(0,t.jsx)("h3",{children:"Customer"}),(0,t.jsxs)("p",{children:["Name: ",o.name]}),(0,t.jsxs)("p",{children:["Address: ",o.address]}),(0,t.jsxs)("p",{children:["Tel: ",o.tel]}),(0,t.jsxs)("p",{children:["Email: ",o.email]}),(0,t.jsx)("h3",{children:"Products"}),(0,t.jsxs)("table",{className:"table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"hidden md:table-row",children:[(0,t.jsx)("th",{children:"Name"}),(0,t.jsx)("th",{children:"Quantity"}),(0,t.jsx)("th",{className:"text-right",children:"Unit Price (\xA3)"}),(0,t.jsx)("th",{className:"text-right",children:"Subtotal (\xA3)"})]})}),(0,t.jsxs)("tbody",{children:[a&&a.map(({invprod_id:d,name:g,quantity:p,price:x})=>(0,t.jsxs)("tr",{className:b,children:[(0,t.jsx)("td",{"data-label":"Name",className:u,children:g}),(0,t.jsx)("td",{"data-label":"Quantity",className:u,children:p}),(0,t.jsx)("td",{"data-label":"Unit Price (\xA3)",className:`${u} md:text-right`,children:x}),(0,t.jsx)("td",{"data-label":"Subtotal (\xA3)",className:`${u} md:text-right`,children:x*p})]},d)),(0,t.jsxs)("tr",{className:b,children:[(0,t.jsx)("td",{colSpan:3,className:"hidden md:table-cell"}),(0,t.jsxs)("td",{className:"md:text-right",children:["Labour cost (\xA3): ",r]})]}),(0,t.jsxs)("tr",{className:b,children:[(0,t.jsx)("td",{colSpan:3,className:"hidden md:table-cell"}),(0,t.jsxs)("td",{className:"md:text-right",children:["Total cost (\xA3): ",M]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end mt-4 gap-4",children:[(0,t.jsx)("a",{href:`/quotes/${s.quote_id}/generatedquote`,target:"_blank",className:"btn",rel:"noreferrer",children:"Generate"}),(0,t.jsx)("button",{className:"btn",onClick:()=>{v(!0)},children:"Share"}),(0,t.jsx)("a",{href:"/quotes",className:"btn",children:"Back"})]}),(0,t.jsxs)(w,{open:N,children:[(0,t.jsx)("h3",{className:"mb-4",children:"Share with:"}),N&&(0,t.jsx)(k,{quoteid:s.quote_id,customer:o,user:i,navigation:f,formErrors:c==null?void 0:c.shareActionErrors,onCancel:()=>{v(!1),c&&(c.shareActionErrors={})}})]})]})}export{I as default,V as meta};
